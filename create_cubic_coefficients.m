function [eq, f1, f2] = create_cubic_coefficients(a,b,c,d,t1,t2,e_,e,u_,u,v_,v)
% on the reference view: e, u, v
% on another view: e_, u_, v_

% first cubic (r0 + r1.*x1 + r2.*x2 + r3.*x1.*x2 + r4.*x1.^2 + r5.*x2.^2 + r6.*x1.*x2.^2 + r7.*x2.*x1.^2)
r0 = e_.*a.^2.*t2.^2 - 2.*v_.*a.^2.*t2 + a.^2+ e_.*b.^2.*t2.^2 - 2.*v_.*b.^2.*t2 + b.^2 - e_.*c.^2.*t1.^2 + 2.*u_.*c.^2.*t1 - c.^2 - e_.*d.^2.*t1.^2 + 2.*u_.*d.^2.*t1 - d.^2;
r1 = - 2.*e_.*u.*a.*t2.^2+ 4.*u.*v_.*a.*t2- 2.*u.*a - 2.*e_.*v.*b.*t2.^2 + 4.*v.*v_.*b.*t2 - 2.*v.*b - 2.*e_.*c.^2.*t1 + 2.*u_.*c.^2 - 2.*e_.*d.^2.*t1 + 2.*u_.*d.^2;
r2 = 2.*e_.*a.^2.*t2 - 2.*v_.*a.^2 + 2.*e_.*b.^2.*t2 - 2.*v_.*b.^2 + 2.*e_.*u.*c.*t1.^2 - 4.*u.*u_.*c.*t1 + 2.*u.*c + 2.*e_.*v.*d.*t1.^2 - 4.*u_.*v.*d.*t1 + 2.*v.*d;
r3 = - 4.*e_.*u.*a.*t2+ 4.*u.*v_.*a - 4.*e_.*v.*b.*t2 + 4.*v.*v_.*b + 4.*e_.*u.*c.*t1 - 4.*u.*u_.*c + 4.*e_.*v.*d.*t1 - 4.*u_.*v.*d;
r4 =  - e_.*c.^2 - e_.*d.^2 + e.*e_.*t2.^2 - 2.*e.*v_.*t2 + e;
r5 = e_.*a.^2 + e_.*b.^2 - e.*e_.*t1.^2 + 2.*e.*u_.*t1 - e;
r6 =  - 2.*e_.*v.*b- 2.*e_.*u.*a  - 2.*e.*e_.*t1 + 2.*e.*u_;
r7 =  2.*e_.*u.*c + 2.*e_.*v.*d + 2.*e.*e_.*t2 - 2.*e.*v_;

% second cubic is f1 x1 + f2 = 0
% f1
p0 = c.^2.*v_ - d.*v - c.*u + d.^2.*v_ - c.^2.*e_.*t2 - d.^2.*e_.*t2 + 2.*c.*t2.*u.*v_ + 2.*d.*t2.*v.*v_ - c.*e_.*t2.^2.*u - d.*e_.*t2.^2.*v;
p1 = -(e_.*c.^2 + e_.*d.^2 - e.*e_.*t2.^2 + 2.*e.*v_.*t2 - e);
p2 = c.*e_.*u - e.*v_ + e.*e_.*t2 + d.*e_.*v;

% f2
p3 = a.*c + b.*d + c.^2.*t2.*u_ + c.^2.*t1.*v_ + d.^2.*t2.*u_ + d.^2.*t1.*v_ - 2.*a.*c.*t2.*v_ - 2.*b.*d.*t2.*v_ + a.*c.*e_.*t2.^2 + b.*d.*e_.*t2.^2 - c.^2.*e_.*t1.*t2 - d.^2.*e_.*t1.*t2;
p4 =  c.^2.*u_ + d.^2.*u_ - a.*u - b.*v - 2.*a.*c.*v_ - 2.*b.*d.*v_ - c.^2.*e_.*t1 - d.^2.*e_.*t1 + 2.*a.*c.*e_.*t2 + 2.*b.*d.*e_.*t2 + 2.*a.*t2.*u.*v_ - 2.*c.*t2.*u.*u_ - 2.*c.*t1.*u.*v_ + 2.*b.*t2.*v.*v_ - 2.*d.*t2.*u_.*v - 2.*d.*t1.*v.*v_ - a.*e_.*t2.^2.*u - b.*e_.*t2.^2.*v + 2.*c.*e_.*t1.*t2.*u + 2.*d.*e_.*t1.*t2.*v;
p5 =  a.*c.*e_ + b.*d.*e_ + 2.*a.*u.*v_ - 2.*c.*u.*u_ + 2.*b.*v.*v_ + e.*t2.*u_ - 2.*d.*u_.*v + e.*t1.*v_ - 2.*a.*e_.*t2.*u + 2.*c.*e_.*t1.*u - 2.*b.*e_.*t2.*v - e.*e_.*t1.*t2 + 2.*d.*e_.*t1.*v;
p6 =  e.*u_ - a.*e_.*u - b.*e_.*v - e.*e_.*t1;

% final polynomial (6 degree)
q0 =  r0.*p0.^2 - r1.*p0.*p3+ r4.*p3.^2;
q1 =  r2.*p0.^2 + 2.*r0.*p0.*p1 - r3.*p0.*p3 - r1.*p0.*p4 - r1.*p1.*p3 + r7.*p3.^2 + 2.*r4.*p3.*p4;
q2 =  r5.*p0.^2 + 2.*r2.*p0.*p1 + 2.*r0.*p0.*p2 - r6.*p0.*p3 - r3.*p0.*p4 - r1.*p0.*p5 + r0.*p1.^2 - r3.*p1.*p3 - r1.*p1.*p4 - r1.*p2.*p3 + 2.*r7.*p3.*p4 + 2.*r4.*p3.*p5  + r4.*p4.^2;
q3 =  2.*r5.*p0.*p1 + 2.*r2.*p0.*p2 - r6.*p0.*p4 - r3.*p0.*p5 - r1.*p0.*p6 + r2.*p1.^2 + 2.*r0.*p1.*p2 - r6.*p1.*p3 - r3.*p1.*p4 - r1.*p1.*p5 - r3.*p2.*p3 - r1.*p2.*p4 + 2.*r7.*p3.*p5 + 2.*r4.*p3.*p6 + r7.*p4.^2 + 2.*r4.*p4.*p5;
q4 =  2.*r5.*p0.*p2 - r6.*p0.*p5 - r3.*p0.*p6 + r5.*p1.^2 + 2.*r2.*p1.*p2 - r6.*p1.*p4 - r3.*p1.*p5 - r1.*p1.*p6 + r0.*p2.^2 - r6.*p2.*p3 - r3.*p2.*p4 - r1.*p2.*p5 + 2.*r7.*p3.*p6 + 2.*r7.*p4.*p5 + 2.*r4.*p4.*p6 + r4.*p5.^2;
q5 =  r6.*p0.*p6 + 2.*r5.*p1.*p2 - r6.*p1.*p5 - r3.*p1.*p6 + r2.*p2.^2 - r6.*p2.*p4 - r3.*p2.*p5 - r1.*p2.*p6 + 2.*r7.*p4.*p6 + r7.*p5.^2 + 2.*r4.*p5.*p6 - 2.*p0.*r6.*p6;
q6 =  r6.*p1.*p6 + r5.*p2.^2 - r6.*p2.*p5 - r3.*p2.*p6 + 2.*r7.*p5.*p6 + r4.*p6.^2 - 2.*p1.*r6.*p6;
% q7 =   - r6.*p2.*p6 + r7.*p6.^2; % verified to be zero

eq = [q0; q1; q2; q3; q4; q5; q6];
f1 = [p0; p1; p2];
f2 = [p3; p4; p5; p6];

end
